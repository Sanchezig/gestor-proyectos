<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Proyectos</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Izquierdo -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>Gestor Proyectos</h1>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title" onclick="toggleSidebarSection('activos')">
                    <span>ðŸ“Š Activos</span>
                    <span class="section-toggle-icon" data-collapsed="false"></span>
                </div>
                <div id="projectsListActive" class="projects-list expanded"></div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title" onclick="toggleSidebarSection('completados')">
                    <span>âœ… Completados</span>
                    <span class="section-toggle-icon" data-collapsed="false"></span>
                </div>
                <div id="projectsListCompleted" class="projects-list expanded"></div>
            </div>

            <div class="sidebar-actions">
                <button onclick="openNewProjectModal()" class="btn-new-project">âž• Nuevo Proyecto</button>
                <button onclick="changeUser()" class="btn-change-user">ðŸ‘¤ Usuario</button>
            </div>

            <div class="sidebar-footer">
                <div id="currentUserDisplay" style="text-align: center; color: #666; font-size: 12px;"></div>
            </div>
        </aside>

        <!-- Contenido Principal -->
        <main class="main-content">
            <!-- Barra de NavegaciÃ³n -->
            <nav class="navbar">
                <button class="nav-btn active" onclick="switchView('dashboard')">ðŸ“Š Dashboard</button>
                <button class="nav-btn" onclick="switchView('daily')">ðŸ“‹ Daily</button>
                <button class="nav-btn" onclick="switchView('team')">ðŸ‘¥ Equipo</button>
                <button class="nav-btn" onclick="switchView('ficha')">ðŸ“„ Ficha</button>
            </nav>

            <!-- Vistas -->
            <div class="views-container">
                <!-- Dashboard -->
                <div id="dashboardView" class="view active"></div>

                <!-- Daily -->
                <div id="dailyView" class="view">
                    <div class="daily-header">
                        <div class="daily-tabs">
                            <button id="btnDailyActivos" class="daily-tab active" onclick="setDailyViewMode('activos')">ðŸ“… Activos</button>
                            <button id="btnDailyCompletados" class="daily-tab" onclick="setDailyViewMode('completados')">âœ… Completados</button>
                        </div>
                        <div class="week-nav">
                            <button onclick="previousWeek()">â—€ Anterior</button>
                            <span id="weekInfo" class="week-info"></span>
                            <button onclick="nextWeek()">Siguiente â–¶</button>
                        </div>
                    </div>
                    <div id="dailyTableContainer"></div>
                </div>

                <!-- Team -->
                <div id="teamView" class="view"></div>

                <!-- Ficha -->
                <div id="fichaView" class="view"></div>
            </div>
        </main>
    </div>

    <!-- Modal: Nuevo Proyecto -->
    <div id="projectModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">Nuevo Proyecto</h2>
            <div class="form-group">
                <label>Nombre</label>
                <input type="text" id="projectName" placeholder="Nombre del proyecto">
            </div>
            <div class="form-group">
                <label>Fecha Inicio</label>
                <input type="date" id="projectStartDate">
            </div>
            <div class="form-group">
                <label>Fecha Fin</label>
                <input type="date" id="projectEndDate">
            </div>
            <div class="form-group">
                <label>Ahorro â‚¬</label>
                <input type="number" id="volume" placeholder="0.00" step="0.01" min="0">
            </div>
            <div class="form-group">
                <label>Ahorro FTE</label>
                <input type="number" id="fte" placeholder="0.0" step="0.1" min="0">
            </div>
            <div class="form-group">
                <label>Fase</label>
                <select id="projectPhase">
                    <option value="Idea">Idea</option>
                    <option value="En Progreso">En Progreso</option>
                    <option value="On Hold">On Hold</option>
                    <option value="Cerrado">Cerrado</option>
                </select>
            </div>
            <div class="form-group">
                <label>Stakeholders</label>
                <input type="text" id="projectStakeholders" placeholder="IS, DH, HR...">
            </div>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="saveNewProject()">Crear</button>
                <button class="btn btn-cancel" onclick="closeProjectModal()">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal: Comentario Daily -->
    <div id="dailyModal" class="modal">
        <div class="modal-content">
            <h2 id="dailyModalTitle" class="modal-title">Nuevo comentario Daily</h2>
            <div class="form-group">
                <label>Proyecto</label>
                <select id="commentProjectSelect"></select>
            </div>
            <div class="form-group">
                <label>Responsable</label>
                <input type="text" id="commentResponsible" placeholder="Iniciales">
            </div>
            <div class="form-group">
                <label>Urgencia</label>
                <select id="commentUrgency">
                    <option>Normal</option>
                    <option>Alta</option>
                    <option>MÃ¡xima</option>
                </select>
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="commentIncident"> Incidente
                </label>
            </div>
            <div class="form-group">
                <label>Comentario</label>
                <textarea id="commentText" placeholder="Escribe aquÃ­..."></textarea>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="saveDailyComment()">Guardar</button>
                <button class="btn btn-cancel" onclick="closeDailyModal()">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal: Lista de Comentarios -->
    <div id="commentsListModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">Comentarios</h2>
            <div id="commentsListContainer"></div>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="openAddCommentFromList()">âž• AÃ±adir</button>
                <button class="btn btn-cancel" onclick="closeCommentsListModal()">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Modal: Vacaciones -->
    <div id="vacationModal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">Selecciona dÃ­as de vacaciones</h2>
            <div id="vacationCalendar" style="text-align: center; padding: 20px;"></div>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="addVacationWithDateRange()">âœ… Crear</button>
                <button class="btn btn-cancel" onclick="closeVacationModal()">Cancelar</button>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config.js"></script>
    <script src="app.js"></script>
</body>
</html>